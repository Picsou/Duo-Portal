<html>
    
    <head>
        <script type="text/javascript" src="js/static.js"></script>
        <script type="text/javascript" src="js/crafty.js"></script>	
		<script type="text/javascript" src="js/network.js"></script>
		<script type="text/javascript" src="js/craftyComponents.js"></script>
        <link href="css/screen.css" type="text/css" rel="stylesheet" />
        <title>Collaborative 2D Portal Game</title>
        <style>
            body, html {
                margin: 0;
                padding: 0;
                font-family: Arial;
                font-size: 20px;
            }
            #cr-stage {
                border: 2px solid black;
                margin: 5px auto;
                color: white;
            }
        </style>
    </head>
    
    <body style="background: #222222 url(../images/bg-checker.png);">
        <audio controls>
            <source src="musics/Portal 2 Want You Gone.wav" type="audio/wav">
        </audio>

        <script type="text/javascript">
			var player2 = null;
			var player1 = null;
			var portal = null;

			var yellowPortal;
		    var bluePortal;

			var exitDoor;
		    var collisionParticle;
		    var mouse;

			var vertical_portal2 = "";
			var portal2_last;
			var portalDirectionLast;

			var width = 1245;
			var height = 600;

			function ready() {
				charSpeed = 6;
				gravity = 0.3;

				Crafty.init(width, height);

				Crafty.scene("loading", function () {
				    // Callback method
				    Crafty.load(["./images/background.png"], function () {
				        Crafty.scene("LevelOne");
				    });

				    Crafty.background("#070");
				    Crafty.e("2D, DOM, Text").attr({
				        w: 100,
				        h: 20,
				        x: 150,
				        y: 120
				    })
				        .text("Loading")
				        .css({
				        "text-align": "center"
				    });
				});

				declareComponents();

				Crafty.scene("LevelOne", function () {
				    Crafty.load(["./images/background.png"], function () {
				        // You can add level two here
				    });

					initEntities();

					buildWall(0, 0, 20, "vertical", "active_wall");
					buildWall(0, 0, 52, "horizontal", "active_wall");
					buildWall(width - 24, 0, 20, "vertical", "active_wall");
					buildWall(0, height - 24, 52, "horizontal", "active_wall");	

				    //buildThickWall(5, 20, 5, "inactive_wall");
					//buildThickWall(20, 15, 2, "active_wall");
					//buildThickWall(30, 15, 5, "inactive_wall");
					buildThickWall(45, 15, 1, "inactive_wall");
				}); // Closing levelOne scene

				Crafty.scene("loading");

				updateMessageSystem();

				trigger();
			}
        </script>
        <div id="cr-stage"></div>
        <div style="px;text-align:center;line-height:80px;">
            <textarea id="chat" readonly></textarea>
        </div>
        <div style="px;text-align:center;line-height:80px;">
            <input type="text" id="mes" class="textarea" onKeyDown="message()">
        </div>
        <div style="px;text-align:center;line-height:80px;">fps (<span id="val"></span>):
            <input type="range" id="fps" onChange="update_fps()" min="10" max="60" style="width:300px;" />
        </div>
    </body>

</html>
